Sub ImportiereUndTransformiereRohdaten()
    Dim wsRohdaten As Worksheet
    Dim wsZiel As Worksheet
    Dim letzteZeileRoh As Long, letzteZeileZiel As Long
    Dim dict As Object
    Dim i As Long, colOffset As Long
    Dim vorgangsnummer As String
    Dim frage As String, antwort As String
    
    ' Setze die Arbeitsblätter
    Set wsRohdaten = Worksheets("Rohdaten") ' Passen Sie den Namen an
    Set wsZiel = Worksheets("Ziel") ' Zielarbeitsblatt
    
    ' Löschen des Zielblatts, um es neu zu befüllen
    wsZiel.Cells.Clear
    
    ' Erstellen eines Dictionarys für die Transformation
    Set dict = CreateObject("Scripting.Dictionary")
    
    ' Letzte Zeile in den Rohdaten ermitteln
    letzteZeileRoh = wsRohdaten.Cells(wsRohdaten.Rows.Count, 2).End(xlUp).Row
    
    ' Überschriften im Zielblatt festlegen
    wsZiel.Cells(1, 1).Value = "Vorgangsnummer"
    
    ' Durch die Rohdaten iterieren
    For i = 2 To letzteZeileRoh
        vorgangsnummer = wsRohdaten.Cells(i, 2).Value
        frage = wsRohdaten.Cells(i, 10).Value
        antwort = wsRohdaten.Cells(i, 11).Value
        
        ' Wenn die Vorgangsnummer noch nicht existiert, dann hinzufügen
        If Not dict.exists(vorgangsnummer) Then
            letzteZeileZiel = wsZiel.Cells(wsZiel.Rows.Count, 1).End(xlUp).Row + 1
            dict(vorgangsnummer) = letzteZeileZiel
            wsZiel.Cells(letzteZeileZiel, 1).Value = vorgangsnummer
        End If
        
        ' Frage und Antwort in die nächste freie Spalte einfügen
        letzteZeileZiel = dict(vorgangsnummer)
        colOffset = wsZiel.Cells(1, wsZiel.Columns.Count).End(xlToLeft).Column + 1

        If wsZiel.Cells(1, colOffset).Value = "" Then
            wsZiel.Cells(1, colOffset).Value = "Frage " & colOffset - 1
            wsZiel.Cells(1, colOffset + 1).Value = "Antwort " & colOffset - 1
        End If

        wsZiel.Cells(letzteZeileZiel, colOffset).Value = frage
        wsZiel.Cells(letzteZeileZiel, colOffset + 1).Value = antwort
    Next i
    
    ' Autofit der Spalten im Zielblatt
    wsZiel.Columns.AutoFit

    ' Abschlussmeldung
    MsgBox "Daten wurden erfolgreich importiert und transformiert!", vbInformation
End Sub
