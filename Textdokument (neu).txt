Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    Dim logSheet As Worksheet
    Set logSheet = ThisWorkbook.Sheets("Log") ' Hier den Namen deines Log-Blatts eintragen

    Dim lastRow As Long
    lastRow = logSheet.Cells(logSheet.Rows.Count, "A").End(xlUp).Row + 1

    logSheet.Cells(lastRow, 1).Value = "Datei gespeichert am: " & Now() & " von Benutzer: " & Environ("USERNAME")

    ' Log f체r ver채nderte Zellen
    Dim changedCells As Range
    Set changedCells = Nothing

    Dim cell As Range
    For Each cell In ThisWorkbook.Sheets("DeinBlatt").UsedRange ' Hier den Namen deines Blatts eintragen
        If cell.Value <> cell.Value2 Then
            If changedCells Is Nothing Then
                Set changedCells = cell
            Else
                Set changedCells = Union(changedCells, cell)
            End If
        End If
    Next cell

    If Not changedCells Is Nothing Then
        lastRow = logSheet.Cells(logSheet.Rows.Count, "A").End(xlUp).Row + 1
        logSheet.Cells(lastRow, 1).Value = "Ver채nderte Zellen:"

        Dim c As Range
        For Each c In changedCells
            lastRow = lastRow + 1
            logSheet.Cells(lastRow, 1).Value = "Zelle " & c.Address & " ge채ndert von " & c.Value2 & " auf " & c.Value & " am " & Now() & " von Benutzer: " & Environ("USERNAME")
        Next c
    End If

End Sub
