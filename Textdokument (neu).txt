Option Explicit

Dim StopLoop As Boolean ' Variable zum Stoppen des Makros

Sub StartExcelKeepActive()
    Dim wb As Workbook
    Dim filePath As String
    StopLoop = False ' Stop-Variable auf "False" setzen

    ' Pfad zur Datei automatisch bestimmen
    filePath = ThisWorkbook.Path & "\Rohdaten.xlsx"

    Do While Not StopLoop
        ' Prüfen, ob Datei existiert
        If Dir(filePath) <> "" Then
            ' Excel-Datei öffnen
            Set wb = Workbooks.Open(filePath)
            Application.Wait Now + TimeValue("00:00:05") ' 5 Sekunden offen lassen
            wb.Close False ' Datei schließen (ohne Speichern)
        End If

        ' Wartezeit von 60 Sekunden, ohne Excel zu blockieren
        Dim StartTime As Double
        StartTime = Timer
        Do While Timer < StartTime + 60
            DoEvents ' Verhindert Einfrieren von Excel
            If StopLoop Then Exit Sub ' Falls Stop gedrückt wird, verlässt es die Schleife
        Loop
    Loop
End Sub

Sub StopExcelKeepActive()
    StopLoop = True ' Stoppt die Schleife beim nächsten Durchlauf
End Sub
