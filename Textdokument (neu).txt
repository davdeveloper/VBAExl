Sub DatenZuweisung()
    Dim wsRohdaten As Worksheet
    Dim wsZuweisung As Worksheet
    Dim ZielBlatt As Worksheet
    Dim letzteZeileRoh As Long, letzteZeileZuweisung As Long
    Dim i As Long, j As Long
    Dim Schluessel As String
    Dim ZielName As String
    Dim Vorgangsnummer As String
    Dim Kategorie As String
    Dim Datum As String
    Dim Wert As String

    ' Arbeitsblätter definieren
    Set wsRohdaten = ThisWorkbook.Sheets("Rohdaten")
    Set wsZuweisung = ThisWorkbook.Sheets("Zuweisung")

    ' Letzte Zeile in den Arbeitsblättern finden
    letzteZeileRoh = wsRohdaten.Cells(wsRohdaten.Rows.Count, 1).End(xlUp).Row
    letzteZeileZuweisung = wsZuweisung.Cells(wsZuweisung.Rows.Count, 1).End(xlUp).Row

    ' Durch die Zeilen der Rohdaten iterieren
    For i = 2 To letzteZeileRoh ' Annahme: Header in Zeile 1
        Schluessel = wsRohdaten.Cells(i, 1).Value
        Vorgangsnummer = wsRohdaten.Cells(i, 2).Value
        Kategorie = wsRohdaten.Cells(i, 3).Value
        Datum = wsRohdaten.Cells(i, 4).Value
        Wert = wsRohdaten.Cells(i, 5).Value

        ' Nach Schlüssel im Arbeitsblatt "Zuweisung" suchen
        For j = 2 To letzteZeileZuweisung
            If wsZuweisung.Cells(j, 2).Value = Schluessel Then
                ZielName = wsZuweisung.Cells(j, 3).Value

                ' Ziel-Arbeitsblatt überprüfen und Daten einfügen
                On Error Resume Next
                Set ZielBlatt = ThisWorkbook.Sheets(ZielName)
                On Error GoTo 0

                If Not ZielBlatt Is Nothing Then
                    Dim letzteZeileZiel As Long
                    letzteZeileZiel = ZielBlatt.Cells(ZielBlatt.Rows.Count, 1).End(xlUp).Row + 1

                    ZielBlatt.Cells(letzteZeileZiel, 1).Value = Vorgangsnummer
                    ZielBlatt.Cells(letzteZeileZiel, 2).Value = Kategorie
                    ZielBlatt.Cells(letzteZeileZiel, 3).Value = Datum
                    ZielBlatt.Cells(letzteZeileZiel, 4).Value = Wert
                End If

                ' Zielblatt-Referenz zurücksetzen
                Set ZielBlatt = Nothing

                ' Schlüssel gefunden, nächste Zeile
                Exit For
            End If
        Next j
    Next i

    MsgBox "Datenzuweisung abgeschlossen!", vbInformation
End Sub
