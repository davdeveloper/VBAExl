Sub KonsolidiereRohdaten()
    Dim ws As Worksheet
    Dim dict As Object
    Dim letzteZeile As Long
    Dim zeile As Long
    Dim vorgangsnummer As String
    Dim frage As String
    Dim antwort As String
    Dim ergebnisRow As Long
    
    ' Arbeitsblatt "Rohdaten" auswählen
    Set ws = ThisWorkbook.Worksheets("Rohdaten")
    
    ' Dictionary erstellen für die Konsolidierung
    Set dict = CreateObject("Scripting.Dictionary")
    
    ' Letzte Zeile in den Rohdaten ermitteln
    letzteZeile = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Durch die Zeilen iterieren und Daten in das Dictionary aufnehmen
    For zeile = 2 To letzteZeile ' Start bei 2, da erste Zeile die Überschrift ist
        vorgangsnummer = ws.Cells(zeile, 2).Value ' Vorgangsnummer aus Spalte B
        frage = ws.Cells(zeile, 10).Value ' Frage aus Spalte J
        antwort = ws.Cells(zeile, 11).Value ' Antwort aus Spalte K
        
        ' Wenn die Vorgangsnummer noch nicht im Dictionary ist, hinzufügen
        If Not dict.exists(vorgangsnummer) Then
            dict.Add vorgangsnummer, Array(ws.Cells(zeile, 1).Value, ws.Cells(zeile, 3).Value, ws.Cells(zeile, 4).Value, ws.Cells(zeile, 5).Value, ws.Cells(zeile, 6).Value, ws.Cells(zeile, 7).Value, ws.Cells(zeile, 8).Value, ws.Cells(zeile, 9).Value, frage & ": " & antwort)
        Else
            ' Wenn die Vorgangsnummer schon existiert, die Frage und Antwort hinzufügen
            Dim tempArray As Variant
            tempArray = dict(vorgangsnummer)
            tempArray(UBound(tempArray)) = tempArray(UBound(tempArray)) & " | " & frage & ": " & antwort
            dict(vorgangsnummer) = tempArray
        End If
    Next zeile
    
    ' Ergebnisse in ein neues Blatt schreiben
    Dim ergebnisWs As Worksheet
    On Error Resume Next
    Set ergebnisWs = ThisWorkbook.Worksheets("Ergebnis")
    If ergebnisWs Is Nothing Then
        Set ergebnisWs = ThisWorkbook.Worksheets.Add
        ergebnisWs.Name = "Ergebnis"
    End If
    On Error GoTo 0
    
    ergebnisWs.Cells.Clear
    
    ' Überschriften hinzufügen
    ergebnisWs.Cells(1, 1).Value = "Vorgangsnummer"
    ergebnisWs.Cells(1, 2).Value = "Zusammengefasste Daten"
    
    ' Konsolidierte Daten eintragen
    ergebnisRow = 2
    Dim key As Variant
    For Each key In dict.keys
        ergebnisWs.Cells(ergebnisRow, 1).Value = key
        ergebnisWs.Cells(ergebnisRow, 2).Value = Join(dict(key), " | ")
        ergebnisRow = ergebnisRow + 1
    Next key
    
    MsgBox "Daten wurden erfolgreich konsolidiert und in das Blatt 'Ergebnis' geschrieben.", vbInformation
End Sub
