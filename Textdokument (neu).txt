Sub TransformiereRohdaten()
    Dim wsRohdaten As Worksheet
    Dim wsDashboard As Worksheet
    Dim dict As Object
    Dim lastRow As Long, i As Long, j As Long
    Dim vorgangsNummer As String
    Dim newRow As Long

    ' Setze die Arbeitsblätter
    Set wsRohdaten = ThisWorkbook.Sheets("Rohdaten")
    Set wsDashboard = ThisWorkbook.Sheets("Dashboard")

    ' Dictionary für die Zusammenführung
    Set dict = CreateObject("Scripting.Dictionary")

    ' Finde die letzte Zeile in Rohdaten
    lastRow = wsRohdaten.Cells(wsRohdaten.Rows.Count, 1).End(xlUp).Row

    ' Rohdaten ab Zeile 2 durchlaufen
    For i = 2 To lastRow
        vorgangsNummer = wsRohdaten.Cells(i, 2).Value

        ' Wenn Vorgangsnummer nicht im Dictionary, dann hinzufügen
        If Not dict.exists(vorgangsNummer) Then
            dict.Add vorgangsNummer, dict.Count + 1
            newRow = dict(vorgangsNummer)

            ' Basisdaten in neues Arbeitsblatt kopieren
            wsDashboard.Cells(newRow + 1, 1).Value = wsRohdaten.Cells(i, 1).Value ' Schlüssel
            wsDashboard.Cells(newRow + 1, 2).Value = vorgangsNummer ' Vorgangsnummer
            wsDashboard.Cells(newRow + 1, 3).Value = wsRohdaten.Cells(i, 3).Value ' Kategorie
            wsDashboard.Cells(newRow + 1, 4).Value = wsRohdaten.Cells(i, 4).Value ' Datum
            wsDashboard.Cells(newRow + 1, 5).Value = wsRohdaten.Cells(i, 5).Value ' Kommentar
            For j = 6 To 9
                wsDashboard.Cells(newRow + 1, j).Value = wsRohdaten.Cells(i, j).Value ' Punkte
            Next j
        End If

        ' Frage und Antwort hinzufügen
        newRow = dict(vorgangsNummer)
        Dim colOffset As Integer
        colOffset = 10 + (dict.Item(vorgangsNummer) - 1) * 2
        wsDashboard.Cells(newRow + 1, colOffset).Value = wsRohdaten.Cells(i, 10).Value ' Frage
        wsDashboard.Cells(newRow + 1, colOffset + 1).Value = wsRohdaten.Cells(i, 11).Value ' Antwort
    Next i

    ' Spaltenüberschriften hinzufügen
    wsDashboard.Cells(1, 1).Value = "Schlüssel"
    wsDashboard.Cells(1, 2).Value = "Vorgangsnummer"
    wsDashboard.Cells(1, 3).Value = "Kategorie"
    wsDashboard.Cells(1, 4).Value = "Datum"
    wsDashboard.Cells(1, 5).Value = "Kommentar"
    wsDashboard.Cells(1, 6).Value = "Punkte 1"
    wsDashboard.Cells(1, 7).Value = "Punkte 2"
    wsDashboard.Cells(1, 8).Value = "Punkte 3"
    wsDashboard.Cells(1, 9).Value = "Punkte 4"

    Dim col As Integer
    col = 10
    Do While wsDashboard.Cells(1, col).Value = ""
        wsDashboard.Cells(1, col).Value = "Frage " & ((col - 10) \ 2 + 1)
        wsDashboard.Cells(1, col + 1).Value = "Antwort " & ((col - 10) \ 2 + 1)
        col = col + 2
    Loop

    MsgBox "Rohdaten wurden erfolgreich transformiert!"
End Sub
