Sub FilterUndÜbertragen()
    Dim sfSheet As Worksheet
    Dim levelSheet As Worksheet
    Dim sfLastRow As Long
    Dim levelLastRow As Long
    Dim sfRange As Range
    Dim filterCriteria As String
    Dim filteredData As Variant
    Dim i As Long, j As Long
    
    ' Definiere Arbeitsblätter
    Set sfSheet = ThisWorkbook.Sheets("SF")
    Set levelSheet = ThisWorkbook.Sheets("Level_Zuordnung")
    
    ' Finde die letzte Zeile in SF
    sfLastRow = sfSheet.Cells(sfSheet.Rows.Count, "A").End(xlUp).Row
    
    ' Setze Filterkriterium
    filterCriteria = "Lidl"
    
    ' Wende den Filter an
    With sfSheet
        .AutoFilterMode = False
        .Range("A1:D1").AutoFilter Field:=4, Criteria1:=filterCriteria
    End With
    
    ' Definiere den relevanten Bereich nach dem Filter
    Set sfRange = sfSheet.Range("A1:A" & sfLastRow).SpecialCells(xlCellTypeVisible)
    
    ' Übertrage die gefilterten Daten in das Arbeitsblatt "Level_Zuordnung"
    levelSheet.Range("A:A").Clear  ' Lösche alle Daten in Spalte A von "Level_Zuordnung"
    levelLastRow = sfRange.Rows.Count
    If levelLastRow > 1 Then
        filteredData = sfRange.Value
        levelSheet.Range("A1:A" & levelLastRow).Value = filteredData
    End If
    
    ' Deaktiviere den Filter
    sfSheet.AutoFilterMode = False
    
    ' Hinweis für den Benutzer
    MsgBox "Die Daten wurden erfolgreich übertragen.", vbInformation
End Sub
