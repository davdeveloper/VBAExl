Sub SucheSchnellUndSchreibeVorgangsnummern()
    Dim wbLevel As Workbook
    Dim wsZiel As Worksheet, wsLevel As Worksheet
    Dim vorgangsNummernDict As Object
    Dim i As Long, letzteZeileLevel As Long
    Dim pfadLevel As String
    Dim vorgangsnummer As Variant
    Dim zielZeile As Long
    
    ' Pfad zu deinen Dateien anpassen
    pfadLevel = "C:\PfadZuDeinerDatei\level.xlsx"
    
    Set wsZiel = ThisWorkbook.ActiveSheet
    Set vorgangsNummernDict = CreateObject("Scripting.Dictionary")
    
    ' Vorgangsnummern aus der aktuellen Arbeitsmappe sammeln
    With wsZiel
        For i = 1 To .Cells(.Rows.Count, "A").End(xlUp).Row
            If Not vorgangsNummernDict.exists(.Cells(i, 1).Value) Then
                vorgangsNummernDict.Add .Cells(i, 1).Value, Nothing
            End If
        Next i
    End With
    
    ' Öffne die Level-Datei und suche nach Vorgangsnummern
    Set wbLevel = Workbooks.Open(pfadLevel)
    Set wsLevel = wbLevel.Sheets(1) ' Gehe davon aus, dass die Daten im ersten Blatt sind
    letzteZeileLevel = wsLevel.Cells(wsLevel.Rows.Count, "A").End(xlUp).Row
    
    zielZeile = wsZiel.Cells(wsZiel.Rows.Count, "A").End(xlUp).Row + 1
    
    For i = 1 To letzteZeileLevel
        vorgangsnummer = wsLevel.Cells(i, 1).Value
        If vorgangsNummernDict.exists(vorgangsnummer) Then
            ' Treffer gefunden, schreibe Vorgangsnummer, Spalte E und F in das Zielarbeitsblatt
            With wsZiel
                .Cells(zielZeile, 1).Value = vorgangsnummer
                .Cells(zielZeile, 2).Value = wsLevel.Cells(i, 5).Value
                .Cells(zielZeile, 3).Value = wsLevel.Cells(i, 6).Value
            End With
            zielZeile = zielZeile + 1
        End If
    Next i
    
    wbLevel.Close False
    
    MsgBox "Vorgangsnummern und Daten wurden erfolgreich übertragen.", vbInformation
End Sub
