Sub DatenImportieren()
    Dim sfWorkbook As Workbook
    Dim zuweisungWorkbook As Workbook
    Dim sfWorksheet As Worksheet
    Dim zuweisungWorksheet As Worksheet
    Dim sfLastRow As Long
    Dim zuweisungLastRow As Long
    Dim i As Long, j As Long
    
    ' Öffne die SF.xlsx-Datei
    Set sfWorkbook = Workbooks.Open("Pfad_zur_SF.xlsx_Datei")
    Set sfWorksheet = sfWorkbook.Sheets(1)
    
    ' Öffne das aktuelle Arbeitsblatt "Zuweisung_Level"
    Set zuweisungWorkbook = ThisWorkbook
    Set zuweisungWorksheet = zuweisungWorkbook.Sheets("Zuweisung_Level")
    
    ' Bestimme die letzte Zeile in SF.xlsx
    sfLastRow = sfWorksheet.Cells(sfWorksheet.Rows.Count, "A").End(xlUp).Row
    
    ' Bestimme die letzte Zeile in "Zuweisung_Level"
    zuweisungLastRow = zuweisungWorksheet.Cells(zuweisungWorksheet.Rows.Count, "A").End(xlUp).Row
    
    ' Filtere nach "Lidl" in Spalte D
    sfWorksheet.Range("D:D").AutoFilter Field:=1, Criteria1:="Lidl"
    
    ' Kopiere die Vorgangsnummern aus Spalte A in "Zuweisung_Level"
    j = zuweisungLastRow + 1
    For i = 2 To sfLastRow
        If Not IsEmpty(sfWorksheet.Cells(i, 1).Value) Then
            zuweisungWorksheet.Cells(j, 1).Value = sfWorksheet.Cells(i, 1).Value
            j = j + 1
        End If
    Next i
    
    ' Deaktiviere den Autofilter
    sfWorksheet.AutoFilterMode = False
    
    ' Schließe die SF.xlsx-Datei ohne zu speichern
    sfWorkbook.Close SaveChanges:=False
    
    MsgBox "Daten wurden importiert.", vbInformation
End Sub
