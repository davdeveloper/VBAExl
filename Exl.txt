Sub SucheUndSchreibeVorgangsnummernSchnell()
    Dim wsZiel As Worksheet
    Dim wbSF As Workbook, wbLevel As Workbook
    Dim wsSF As Worksheet, wsLevel As Worksheet
    Dim letzteZeileSF As Long, letzteZeileLevel As Long, i As Long
    Dim dict As Object
    Dim pfadSF As String, pfadLevel As String
    Dim vorgangsNummer As Variant
    
    ' Anpassen der Pfade zu den Dateien
    pfadSF = "C:\PfadZuDeinerDatei\SF.xlsx"
    pfadLevel = "C:\PfadZuDeinerDatei\level.xlsx"
    
    Set wsZiel = ThisWorkbook.ActiveSheet
    Set dict = CreateObject("Scripting.Dictionary")
    
    ' Öffnen der Level-Datei und Speichern der Vorgangsnummern mit zugehörigen Daten in einem Dictionary
    Set wbLevel = Workbooks.Open(pfadLevel)
    Set wsLevel = wbLevel.Sheets(1) ' Annahme, dass Daten im ersten Blatt sind
    letzteZeileLevel = wsLevel.Cells(wsLevel.Rows.Count, "A").End(xlUp).Row
    
    For i = 1 To letzteZeileLevel
        If Not dict.Exists(wsLevel.Cells(i, 1).Value) Then
            dict.Add wsLevel.Cells(i, 1).Value, wsLevel.Cells(i, 5).Value & "|" & wsLevel.Cells(i, 6).Value
        End If
    Next i
    
    wbLevel.Close False
    
    ' Öffnen der SF-Datei und Durchsuchen nach Vorgangsnummern
    Set wbSF = Workbooks.Open(pfadSF)
    Set wsSF = wbSF.Sheets(1) ' Annahme, dass Daten im ersten Blatt sind
    letzteZeileSF = wsSF.Cells(wsSF.Rows.Count, "A").End(xlUp).Row
    
    For i = 1 To letzteZeileSF
        vorgangsNummer = wsSF.Cells(i, 1).Value
        If dict.Exists(vorgangsNummer) Then
            ' Treffer gefunden, Daten aus dem Dictionary extrahieren und ins Zielarbeitsblatt schreiben
            With wsZiel
                .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Value = vorgangsNummer
                .Cells(.Rows.Count, 1).End(xlUp).Offset(0, 1).Value = Split(dict(vorgangsNummer), "|")(0)
                .Cells(.Rows.Count, 1).End(xlUp).Offset(0, 2).Value = Split(dict(vorgangsNummer), "|")(1)
            End With
        End If
    Next i
    
    wbSF.Close False
    
    MsgBox "Vorgangsnummern und Daten wurden erfolgreich übertragen.", vbInformation
End Sub
